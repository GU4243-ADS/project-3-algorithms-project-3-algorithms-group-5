load("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/data/MS_sim.RData")
load("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/data/EM_sim.RData")
View(MS_sim)
View(movie_sim)
View(MS_sim)
load("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/data/movie_EM_pred_11.RData")
#setwd("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/data")
load("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/data/EM_UI_test.RData")
load("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/data/MS_UI_test.RData")
load("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/data/movie_pred.RData")
load("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/data/MS_pred.RData")
load("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/data/movie_EM_pred_11.RData")
pred <- movie_EM_pred_11
test <- movie_UI_test
#MAE
start_time <- Sys.time()
eva_mae(pred,test)
source("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/lib/evaluation.R")
pred <- movie_EM_pred_11
test <- movie_UI_test
#MAE
start_time <- Sys.time()
eva_mae(pred,test)
packages <- c("MLmetrics","Metrics","tidyverse")
packages <- lapply(packages, FUN = function(x) {
if(!require(x, character.only = TRUE)) {
install.packages(x)
library(x, character.only = TRUE)
}
})
#MAE
start_time <- Sys.time()
eva_mae(pred,test)
end_time <-Sys.time()
end_time - start_time
eva_mae <- function(prediction,test_data){
matrix_mae <- matrix(ncol = 2)
for (i in 1:nrow(test_data)){
cols_to_test <- which(!is.na(test_data[i, ]))
pred  <- prediction[i, ]
mae <- MAE(cols_to_test,pred)
labels <- cbind(i, mae)
matrix_mae <- rbind(matrix_mae,labels)
}
matrix_mae <- na.omit(matrix_mae)
evaluation = sum(matrix_mae[,2])/i
return(evaluation)
}
eva_mae(pred,test)
matrix_mae <- matrix(ncol = 2)
for (i in 1:nrow(test)){
cols_to_test <- which(!is.na(test[i, ]))
pred  <- prediction[i, ]
mae <- MAE(cols_to_test,pred)
labels <- cbind(i, mae)
matrix_mae <- rbind(matrix_mae,labels)
}
matrix_mae <- matrix(ncol = 2)
pred <- movie_EM_pred_11[,1:100]
test <- movie_UI_test[,1:100]
View(pred)
eva_mae <- function(prediction,test_data){
matrix_mae <- matrix(ncol = 2)
for (i in 1:nrow(test_data)){
cols_to_test <- which(!is.na(test_data[i, ]))
pred  <- prediction[i, ]
mae <- MAE(cols_to_test,pred)
labels <- cbind(i, mae)
matrix_mae <- rbind(matrix_mae,labels)
}
matrix_mae <- na.omit(matrix_mae)
evaluation = sum(matrix_mae[,2])/i
return(evaluation)
}
eva_mae(pred,test)
pred <- movie_EM_pred_11
pred <- movie_EM_pred_11
pred <- movie_EM_pred_11
test <- movie_UI_test
eva_mae(pred,test)
#RMSE
eva_rmse(pred,test)
pred <- movie_EM_pred_11[,1:100]
test <- movie_UI_test[,1:100]
pred_MS <- MS_pred[,1:1000]
pred <- movie_EM_pred_11[,1:1000]
test <- movie_UI_test[,1:1000]
eva_mae(pred,test)
View(pred)
View(test)
cols_to_test <- which(!is.na(test[i, ]))
matrix_mae <- matrix(ncol = 2)
for (i in 1:nrow(test)){
cols_to_test <- which(!is.na(test[i, ]))
pred  <- prediction[i, ]
mae <- MAE(cols_to_test,pred)
labels <- cbind(i, mae)
matrix_mae <- rbind(matrix_mae,labels)
}
for (i in 1:nrow(test)){
cols_to_test <- which(!is.na(test[i, ]))
preds  <- pred[i, ]
mae <- MAE(cols_to_test,pred)
labels <- cbind(i, mae)
matrix_mae <- rbind(matrix_mae,labels)
}
matrix_mae <- na.omit(matrix_mae)
View(matrix_mae)
evaluation = sum(matrix_mae[,2])/i
preds  <- pred[i, ]
View(pred)
??MAE
mae <- MAE(pred,cols_to_test)
mae <- MAE(preds,cols_to_test)
mae <- MAE(cols_to_test,preds)
mae <- MAE(preds,cols_to_test)
pred <- movie_EM_pred_11[,1:100]
test <- movie_UI_test[,1:100]
matrix_mae <- matrix(ncol = 2)
for (i in 1:nrow(test)){
cols_to_test <- which(!is.na(test[i, ]))
preds  <- pred[i, ]
mae <- MAE(preds,cols_to_test)
labels <- cbind(i, mae)
matrix_mae <- rbind(matrix_mae,labels)
}
matrix_mae <- na.omit(matrix_mae)
View(matrix_mae)
evaluation = sum(matrix_mae[,2])/i
pred <- movie_EM_pred_11[,1:500]
test <- movie_UI_test[,1:500]
View(pred)
matrix_mae <- matrix(ncol = 2)
for (i in 1:nrow(test)){
cols_to_test <- which(!is.na(test[i, ]))
preds  <- pred[i, ]
mae <- MAE(preds,cols_to_test)
labels <- cbind(i, mae)
matrix_mae <- rbind(matrix_mae,labels)
}
cols_to_test <- which(!is.na(test[i, ]))
cols_to_test <- which(!is.na(test[i, ]))
preds  <- pred[i, ]
View(test)
cols_to_test
cols_to_test <- which(!is.na(test[,i ]))
cols_to_test <- which(!is.na(test[,i]))
cols_to_test <- which(!is.na(test[i,))
cols_to_test <- which(!is.na(test[i,]))
cols_to_test
preds  <- pred[i, ]
cols_to_test <- test[i,]
cols_to_test
cols_to_test <- na.omit(cols_to_test)
preds  <- pred[i, ]
mae <- MAE(preds,cols_to_test)
labels <- cbind(i, mae)
for (i in 1:nrow(test)){
cols_to_test <- test[i,]
cols_to_test <- na.omit(cols_to_test)
preds  <- pred[i, ]
mae <- MAE(preds,cols_to_test)
labels <- cbind(i, mae)
matrix_mae <- rbind(matrix_mae,labels)
}
matrix_mae <- na.omit(matrix_mae)
evaluation = sum(matrix_mae[,2])/i
labels <- cbind(i, mae)
labels <- cbind(i, mae)
matrix_mae <- matrix(ncol = 2)
for (i in 1:nrow(test)){
cols_to_test <- test[i,]
cols_to_test <- na.omit(cols_to_test)
preds  <- pred[i, ]
mae <- MAE(preds,cols_to_test)
labels <- cbind(i, mae)
matrix_mae <- rbind(matrix_mae,labels)
}
matrix_mae <- na.omit(matrix_mae)
evaluation = sum(matrix_mae[,2])/i
cols_to_test <- which(!is.na(test[i, ]))
cols_to_test <- which(!is.na(test[i, ]))
preds  <- pred[i, ]
preds <- preds[,cols_to_test]
cols_to_test
preds <- preds[,3,6,]
preds <- preds[,3,6]
??rep
cols_to_test <- which(is.na(test[i, ]))
preds  <- pred[i, ]
preds  <- pred[i, ]
tests <- test[i,]
cbind(preds,tests)
all <- cbind(preds,tests)
mae <- MAE(all$preds,all$tests)
all <- na.omit(all)
View(all)
mae <- MAE(all$preds,all$tests)
??MAE
all <- as.data.frame(all)
View(all)
mae <- MAE(all$preds,all$tests)
labels <- cbind(i, mae)
matrix_mae <- matrix(ncol = 2)
for (i in 1:nrow(test)){
preds  <- pred[i, ]
tests <- test[i,]
all <- cbind(preds,tests)
all <- na.omit(all)
all <- as.data.frame(all)
mae <- MAE(all$preds,all$tests)
labels <- cbind(i, mae)
matrix_mae <- rbind(matrix_mae,labels)
}
View(matrix_mae)
matrix_mae <- na.omit(matrix_mae)
evaluation = sum(matrix_mae[,2])/i
evaluation = sum(matrix_mae[,2])/i * 100
matrix_mae <- na.omit(matrix_mae)
evaluation = sum(matrix_mae[,2])/i * 100
evaluation = sum(matrix_mae[,2])
evaluation = sum(matrix_mae[,2])/i
evaluation = sum(matrix_mae[,2])/i * 100
evaluation = sum(matrix_mae[,2])/i
evaluation = sum(matrix_mae[,2])
evaluation = sum(matrix_mae[,2])/i
eva_mae <- function(prediction,test_data){
matrix_mae <- matrix(ncol = 2)
for (i in 1:nrow(test_data)){
preds  <- prediction[i, ]
tests <- test_data[i,]
all <- cbind(preds,tests)
all <- na.omit(all)
all <- as.data.frame(all)
mae <- MAE(all$preds,all$tests)
labels <- cbind(i, mae)
matrix_mae <- rbind(matrix_mae,labels)
}
matrix_mae <- na.omit(matrix_mae)
evaluation = sum(matrix_mae[,2])/i
return(evaluation)
}
#MAE
start_time <- Sys.time()
eva_mae(pred,test)
end_time <-Sys.time()
end_time - start_time
#MAE
eva_mae(pred,test)
pred <- movie_EM_pred_11
test <- movie_UI_test
eva_mae <- function(prediction,test_data){
matrix_mae <- matrix(ncol = 2)
for (i in 1:nrow(test_data)){
preds  <- prediction[i, ]
tests <- test_data[i,]
all <- cbind(preds,tests)
all <- na.omit(all)
all <- as.data.frame(all)
mae <- MAE(all$preds,all$tests)
labels <- cbind(i, mae)
matrix_mae <- rbind(matrix_mae,labels)
}
matrix_mae <- na.omit(matrix_mae)
evaluation = sum(matrix_mae[,2])/i
return(evaluation)
}
#MAE
eva_mae(pred,test)
#RMSE
eva_rmse(pred,test)
eva_rmse <- function(prediction, test_data){
matrix_rmse <- matrix(ncol = 2)
for (i in 1:nrow(test_data)){
preds  <- prediction[i, ]
tests <- test_data[i,]
all <- cbind(preds,tests)
all <- na.omit(all)
all <- as.data.frame(all)
RMSE <- rmse(all$tests, all$preds)
labels <- cbind(i, RMSE)
matrix_rmse <- rbind(matrix_rmse,labels)
}
matrix_rmse <- na.omit(matrix_rmse)
evaluation = sum(matrix_rmse[,2])/i
return(evaluation)
}
eva_rmse <- function(prediction, test_data){
matrix_rmse <- matrix(ncol = 2)
for (i in 1:nrow(test_data)){
preds  <- prediction[i, ]
tests <- test_data[i,]
all <- cbind(preds,tests)
all <- na.omit(all)
all <- as.data.frame(all)
RMSE <- rmse(all$tests, all$preds)
labels <- cbind(i, RMSE)
matrix_rmse <- rbind(matrix_rmse,labels)
}
matrix_rmse <- na.omit(matrix_rmse)
evaluation = sum(matrix_rmse[,2])/i
return(evaluation)
}
#RMSE
eva_rmse(pred,test)
load("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/data/MS_for_CF_9.RData")
test_MS <- MS_UI
load("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/data/MS_for_CF_9.RData")
load("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/data/MS_for_CF_9.RData")
load("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/data/MS_for_CF_9.RData")
MS_preds <- load("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/data/MS_for_CF_9.RData")
pred_MS <- MS_preds
load("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/data/MS_for_CF_9.RData")
View(results)
load("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/data/MS_EM_pred_9.RData")
pred_MS <- MS_EM_pred_9
test_MS <- MS_UI
#MAE
eva_mae(pred,test)
#RMSE
eva_rmse(pred,test)
#MAE
eva_mae(pred_MS,test_MS)
#RMSE
eva_rmse(pred_MS,test_MS)
load("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/data/MS_sim_spearman")
load("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/data/MS_sim_spearman.RData")
load("/Users/miezai/Documents/GitHub/project-3-algorithms-project-3-algorithms-group-5/data/MS_sim_spearman.RData")
pred <- movie_EM_pred_11[,1:100]
test <- movie_UI_test[,1:100]
for (i in 2:nrow(pred)){
rank_pred <- sort(pred[i,], decrasing = TRUE)
rank_test_by_pred <- test[i,][names(rank_pred)]
}
rank_pred <- sort(pred[i,], decreasing = TRUE)
for (i in 2:nrow(pred)){
rank_pred <- sort(pred[i,], decreasing = TRUE)
rank_test_by_pred <- test[i,][names(rank_pred)]
}
rank_test_by_pred <- unlist(test[i,][names(rank_pred)])
for (i in 2:nrow(pred)){
rank_pred <- sort(pred[i,], decreasing = TRUE)
rank_test_by_pred <- unlist(test[i,][names(rank_pred)])
}
rank_test_by_pred <- test[i]
rank_test_by_pred <- test[i,]
names(rank_pred)
View(pred)
View(test)
names(test)
names(test[i,])
names(rank_test_by_pred)
rank_pred$id <- row.names(test[i])
View(rank_pred)
rank_pred <- as.data.frame(sort(pred[i,], decreasing = TRUE))
View(rank_pred)
rank_pred$id <- row.names(test[i,])
View(rank_pred)
rank_pred <- pred[i,] %>% as.data.frame() %>% mutate(id = row.names(test[i,]))
rank_pred <- pred[i,] %>% as.data.frame() %>% mutate(id = row.names(pred))
rank_pred <- pred[i,] %>% as.data.frame() %>% mutate(ID = row.names(pred))
rank_pred <- pred[i,] %>% as.data.frame()
rank_pred <- rank_pred %>% mutate(id = row.names(pred))
rank_pred <- rank_pred %>% mutate(ID = row.names(pred))
rank_pred <- rank_pred %>% mutate(ID == row.names(pred))
rank_pred$id <- row.names(rank_pred)
rank_pred <- pred[i,] %>% as.data.frame()
rank_pred <- rank_pred %>% mutate(id = row.names(rank_pred))
View(rank_pred)
rank_pred <- rank_pred %>% mutate(id = row.names(rank_pred)) %>% arrange(desc(.))
View(rank_pred)
rank_pred <- rank_pred %>% mutate(id = row.names(rank_pred)) %>% arrange(desc(.)) %>% mutate(rank = 1:nrow(rank_pred))
rank_pred <- rank_pred %>% mutate(id = row.names(rank_pred)) %>% arrange(desc(.))
rank_pred <- pred[i,] %>% as.data.frame()
rank_pred <- rank_pred %>% mutate(id = row.names(rank_pred)) %>% arrange(desc(.))
rank_pred <- pred[i,] %>% as.data.frame()
rank_pred <- rank_pred %>% mutate(id = row.names(rank_pred)) %>% arrange(desc(.)) %>% mutate(rank = 1:nrow(rank_pred))
View(rank_pred)
rank_test_by_pred <- test[i,] %>% as.data.frame()
rank_test_by_pred <- test[i,] %>% as.data.frame()
rank_test_by_pred <- rank_test_by_pred %>% mutate(id = rank_test_by_pred)
all <- merge(rank_pred, rank_test_by_pred)
View(all)
View(rank_test_by_pred)
rank_test_by_pred <- test[i,] %>% as.data.frame()
View(rank_test_by_pred)
rank_test_by_pred <- rank_test_by_pred %>% mutate(id = row.names(rank_test_by_pred))
rank_test_by_pred <- rank_test_by_pred %>% mutate(id = row.names(rank_test_by_pred)) %>% select(. = "test", id)
rank_test_by_pred <- rank_test_by_pred %>% mutate(id = row.names(rank_test_by_pred))
rank_test_by_pred <- rank_test_by_pred %>% mutate(id = row.names(rank_test_by_pred)) %>% select(. == "test")
rank_test_by_pred <- rank_test_by_pred %>% mutate(id = row.names(rank_test_by_pred)) %>% select("." = "test")
names(rank_test_by_pred) <- c("test","id")
View(rank_test_by_pred)
all <- merge(rank_pred, rank_test_by_pred)
View(all)
all <- all %>% arrange(desc(rank))
all <- all %>% arrange(rank)
matrix_ranks <- matrix(ncol = pred, nrow = test)
matrix_ranks <- matrix(NA, ncol = pred, nrow = test)
pred <- movie_EM_pred_11[,1:100]
test <- movie_UI_test[,1:100]
matrix_ranks <- matrix(NA, ncol = pred, nrow = test)
matrix_ranks <- matrix()
for (i in 2:nrow(pred)){
rank_pred <- pred[i,] %>% as.data.frame()
rank_pred <- rank_pred %>% mutate(id = row.names(rank_pred)) %>% arrange(desc(.)) %>% mutate(rank = 1:nrow(rank_pred))
rank_test_by_pred <- test[i,] %>% as.data.frame()
rank_test_by_pred <- rank_test_by_pred %>% mutate(id = row.names(rank_test_by_pred))
names(rank_test_by_pred) <- c("test","id")
all <- merge(rank_pred, rank_test_by_pred)
all <- all %>% arrange(rank)
result[i,] <- all$test
}
matrix_ranks <- matrix()
for (i in 2:nrow(pred)){
rank_pred <- pred[i,] %>% as.data.frame()
rank_pred <- rank_pred %>% mutate(id = row.names(rank_pred)) %>% arrange(desc(.)) %>% mutate(rank = 1:nrow(rank_pred))
rank_test_by_pred <- test[i,] %>% as.data.frame()
rank_test_by_pred <- rank_test_by_pred %>% mutate(id = row.names(rank_test_by_pred))
names(rank_test_by_pred) <- c("test","id")
all <- merge(rank_pred, rank_test_by_pred)
all <- all %>% arrange(rank)
matrix_ranks[i,] <- all$test
}
print(i)
matrix_ranks <- matrix()
for (i in 2:nrow(pred)){
rank_pred <- pred[i,] %>% as.data.frame()
rank_pred <- rank_pred %>% mutate(id = row.names(rank_pred)) %>% arrange(desc(.)) %>% mutate(rank = 1:nrow(rank_pred))
rank_test_by_pred <- test[i,] %>% as.data.frame()
rank_test_by_pred <- rank_test_by_pred %>% mutate(id = row.names(rank_test_by_pred))
names(rank_test_by_pred) <- c("test","id")
all <- merge(rank_pred, rank_test_by_pred)
all <- all %>% arrange(rank)
print(i)
matrix_ranks[i,] <- all$test
}
matrix_ranks <- matrix(nrow = test)
matrix_ranks <- matrix(nrow(test))
matrix_ranks <- matrix(ncol(test), nrow(test))
View(matrix_ranks)
matrix_ranks <- matrix(NA, ncol(test), nrow(test))
for (i in 2:nrow(pred)){
rank_pred <- pred[i,] %>% as.data.frame()
rank_pred <- rank_pred %>% mutate(id = row.names(rank_pred)) %>% arrange(desc(.)) %>% mutate(rank = 1:nrow(rank_pred))
rank_test_by_pred <- test[i,] %>% as.data.frame()
rank_test_by_pred <- rank_test_by_pred %>% mutate(id = row.names(rank_test_by_pred))
names(rank_test_by_pred) <- c("test","id")
all <- merge(rank_pred, rank_test_by_pred)
all <- all %>% arrange(rank)
print(i)
matrix_ranks[i,] <- all$test
}
for (i in 1:nrow(pred)){
rank_pred <- pred[i,] %>% as.data.frame()
rank_pred <- rank_pred %>% mutate(id = row.names(rank_pred)) %>% arrange(desc(.)) %>% mutate(rank = 1:nrow(rank_pred))
rank_test_by_pred <- test[i,] %>% as.data.frame()
rank_test_by_pred <- rank_test_by_pred %>% mutate(id = row.names(rank_test_by_pred))
names(rank_test_by_pred) <- c("test","id")
all <- merge(rank_pred, rank_test_by_pred)
all <- all %>% arrange(rank)
print(i)
matrix_ranks[i,] <- all$test
}
View(all)
rank_pred <- pred[i,] %>% as.data.frame()
rank_pred <- rank_pred %>% mutate(id = row.names(rank_pred)) %>% arrange(desc(.)) %>% mutate(rank = 1:nrow(rank_pred))
rank_test_by_pred <- test[i,] %>% as.data.frame()
rank_test_by_pred <- rank_test_by_pred %>% mutate(id = row.names(rank_test_by_pred))
names(rank_test_by_pred) <- c("test","id")
all <- merge(rank_pred, rank_test_by_pred)
View(all)
all <- all %>% arrange(rank)
View(rank_pred)
View(rank_test_by_pred)
rank_test_by_pred <- rank_test_by_pred %>% mutate(id = row.names(rank_test_by_pred))
for (i in 1:nrow(pred)){
rank_pred <- pred[i,] %>% as.data.frame()
rank_pred <- rank_pred %>% mutate(id = row.names(rank_pred)) %>% arrange(desc(.)) %>% mutate(rank = 1:nrow(rank_pred))
rank_test_by_pred <- test[i,] %>% as.data.frame()
rank_test_by_pred <- rank_test_by_pred %>% mutate(id = row.names(rank_test_by_pred))
names(rank_test_by_pred) <- c("test","id")
all <- merge(rank_pred, rank_test_by_pred)
all <- all %>% arrange(rank)
print(i)
matrix_ranks[i,] <- all$test
}
rank_test_by_pred <- rank_test_by_pred %>% mutate(id = row.names(rank_test_by_pred))
names(rank_test_by_pred) <- c("test","id")
all <- merge(rank_pred, rank_test_by_pred)
all <- all %>% arrange(rank)
print(i)
matrix_ranks[i,] <- all$test
matrix_ranks[i,] <- unname(all$test)
matrix_ranks[i,] <- all$test
all$test
matrix_ranks[i,] <- all$test
length(matrix_ranks)
View(matrix_ranks)
pred <- movie_EM_pred_11[,1:100]
test <- movie_UI_test[,1:100]
matrix_ranks <- matrix(NA, ncol(test), nrow(test))
for (i in 1:nrow(pred)){
rank_pred <- pred[i,] %>% as.data.frame()
rank_pred <- rank_pred %>% mutate(id = row.names(rank_pred)) %>% arrange(desc(.)) %>% mutate(rank = 1:nrow(rank_pred))
rank_test_by_pred <- test[i,] %>% as.data.frame()
rank_test_by_pred <- rank_test_by_pred %>% mutate(id = row.names(rank_test_by_pred))
names(rank_test_by_pred) <- c("test","id")
all <- merge(rank_pred, rank_test_by_pred)
all <- all %>% arrange(rank)
matrix_ranks[i,] <- all$test
}
